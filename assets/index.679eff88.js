var ee=Object.defineProperty;var H=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var U=(r,t,a)=>t in r?ee(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,j=(r,t)=>{for(var a in t||(t={}))te.call(t,a)&&U(r,a,t[a]);if(H)for(var a of H(t))re.call(t,a)&&U(r,a,t[a]);return r};import{j as d,B as P,a as e,u as ie,T as m,r as b,S as M,C as W,b as G,c as K,F as N,L as q,d as oe,e as ne,f as ae,I as se,g as le,h as de,G as ce,i as ue,V as A,k as he,M as be,l as V,H as Y,m as ge,n as fe,o as pe,R as me,p as k,q as Se,s as ve,t as Le}from"./vendor.f70b9a23.js";const Ee=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const g of l.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&c(g)}).observe(document,{childList:!0,subtree:!0});function a(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerpolicy&&(l.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?l.credentials="include":n.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(n){if(n.ep)return;n.ep=!0;const l=a(n);fetch(n.href,l)}};Ee();var xe="/cs-react-interview-exercise/assets/header_logo.1094da8d.png";const B="80px",Te=({children:r})=>d(P,{className:"cs-header",position:"fixed",top:"0",right:"0",left:"0",width:"100vw",height:B,display:"flex",justifyContent:"center",children:[e("a",{href:"https://characterstrong.com",children:e("img",{className:"header-img",src:xe,alt:"CharacterStrong Logo"})}),r]});function Ce(r){const{districts:t}=r,a=ie();return e(P,{width:"100%",borderWidth:1,borderRadius:"xl",overflow:"hidden",children:t.map(c=>e(P,{borderBottomWidth:1,p:4,_last:{borderBottomWidth:0},_hover:{backgroundColor:"blackAlpha.50",cursor:"pointer"},onClick:()=>a(`/districts/${c.LEAID}`),children:e(m,{children:c.NAME})}))})}function R(r,t={}){const{method:a="get",lazy:c=a!="get",debounce:n}=t,[l,g]=b.exports.useState(null),[h,u]=b.exports.useState(null),[i,o]=b.exports.useState(!c),s=b.exports.useRef(null),f=b.exports.useRef(new AbortController),L=b.exports.useCallback(async()=>{const E=async()=>{var x;g(null),o(!0),f.current.abort(),f.current=new AbortController;const p=await fetch(r,{signal:f.current.signal});o(!1),p.ok?((x=p.headers.get("Content-Type"))==null?void 0:x.includes("application/json"))?u(await p.json()):console.error("Unable to handle non-JSON response",p):g(p)};typeof n=="number"?(s.current!==null&&clearTimeout(s.current),s.current=window.setTimeout(E,n)):E()},[r,a]);return b.exports.useEffect(()=>{if(!c)return L(),()=>{s.current!==null&&clearTimeout(s.current)}},[L,c]),{loading:i,data:h,error:l,dispatch:L}}function Ie(r){const t=`UPPER(NAME) LIKE UPPER('%${r}%')`;return`https://nces.ed.gov/opengis/rest/services/K12_School_Locations/EDGE_GEOCODE_PUBLICLEA_1516/MapServer/0/query?where=${encodeURIComponent(t)}&outFields=*&outSR=4326&f=json`}function Z(r){const t=`LEAID = '${r}'`;return`https://nces.ed.gov/opengis/rest/services/School_District_Boundaries/EDGE_ADMINDATA_SCHOOLDISTRICTS_SY1920/MapServer/0/query?where=${encodeURIComponent(t)}&outFields=*&outSR=4326&f=json`}function we(r,t,{searchPrivate:a=!1}){let c=`UPPER(NAME) LIKE UPPER('%${r}%')`;return t!=null&&(c+=` AND LEAID = '${t}'`),`https://services1.arcgis.com/Ua5sjt3LWTPigjyD/arcgis/rest/services/${a?"Private_School_Locations_Current":"Public_School_Location_201819"}/FeatureServer/0/query?where=${encodeURIComponent(c)}&outFields=*&outSR=4326&f=json`}function ye(r,t){const a=`LEAID = '${r}' AND NCESSCH = '${t}'`;return`https://nces.ed.gov/opengis/rest/services/K12_School_Locations/EDGE_ADMINDATA_PUBLICSCH_1920/MapServer/0/query?outFields=*&where=${encodeURIComponent(a)}&f=json`}function z(r){const{breadcrumb:t,loading:a,title:c,children:n}=r;return e(M,{initialScale:.9,in:!0,children:d(W,{width:"4xl",maxWidth:"100%",backgroundColor:"whiteAlpha.800",p:10,borderRadius:"xl",boxShadow:"xl",backdropFilter:"blur(20px) saturate(180%)",children:[a&&e(G,{children:e(K,{size:"xl"})}),e(M,{initialScale:.9,in:!a,children:!a&&d(N,{children:[t&&d(m,{as:q,to:t.to,display:"flex",align:"center",children:[e(oe,{fontSize:"1.5em",marginLeft:"-6px"}),t.content]}),e(m,{fontSize:"3xl",fontWeight:"bold",marginBottom:6,children:c}),n]})})]})})}const O=10;function Ae(){const[r,t]=b.exports.useState("Peninsula School District"),{loading:a,error:c,data:n}=R(Ie(r),{debounce:300}),l=b.exports.useMemo(()=>n?n.features.map(h=>h.attributes).filter(Boolean):[],[n]),g=b.exports.useMemo(()=>l.slice(0,O),[l]);return d(z,{title:"Search districts",children:[d(ne,{marginBottom:4,children:[e(ae,{id:"DistrictName",children:"District name"}),e(se,{size:"lg",value:r,onChange:h=>t(h.target.value),borderRadius:"xl"})]}),a?e(G,{height:"80px",children:e(K,{})}):d(M,{initialScale:.9,in:!a,children:[l.length>0?e(Ce,{districts:g}):e(G,{height:"80px",children:e(m,{children:"No results found."})}),l.length>O&&d(m,{marginTop:4,children:[(l.length-O).toLocaleString()," district(s) not shown. Please refine your search."]})]})]})}function Re(){return e(M,{initialScale:.9,in:!0,children:e(Ae,{})})}function S(r){return d(le,{borderWidth:1,borderRadius:"xl",minWidth:"90px",p:4,align:"center",backgroundColor:"white",flexGrow:1,children:[e(m,{fontWeight:"medium",fontSize:22,children:r.value}),e(m,{textTransform:"uppercase",fontSize:10,fontWeight:"bold",children:r.label}),r.afterValue]})}const De="AIzaSyB4xIAr7G7f9emydvsTtXsGG5KLjPW6im4";function J(r){var h,u;const{district:t,schools:a}=r,[c,n]=b.exports.useState(null),{isLoaded:l}=de({id:"google-map-script",googleMapsApiKey:De}),g=b.exports.useMemo(()=>a.reduce((i,o)=>{var s,f,L,E,p,x,T,w;return(o==null?void 0:o.attributes)&&("LAT"in o.attributes?i.push({lat:o.attributes.LAT||0,long:o.attributes.LON||0,name:o.attributes.NAME||"",address:`${(s=o.attributes)==null?void 0:s.STREET} ${(f=o.attributes)==null?void 0:f.CITY} ${(L=o.attributes)==null?void 0:L.STATE} ${(E=o.attributes)==null?void 0:E.ZIP}`,id:o.attributes.NCESSCH||""}):"LATCOD"in o.attributes&&i.push({lat:o.attributes.LATCOD||0,long:o.attributes.LONCOD||0,name:o.attributes.SCH_NAME||"",address:`${(p=o.attributes)==null?void 0:p.LSTREET1} ${(x=o.attributes)==null?void 0:x.LCITY} ${(T=o.attributes)==null?void 0:T.LSTATE} ${(w=o.attributes)==null?void 0:w.LZIP}`,id:o.attributes.NCESSCH||""})),i},[]),[a]);return e(N,{children:l&&((h=t.attributes)==null?void 0:h.Lat)&&((u=t.attributes)==null?void 0:u.Long)&&e(ce,{mapContainerStyle:{width:"100%",height:400,borderRadius:10},center:{lat:t.attributes.Lat,lng:t.attributes.Long},zoom:10,children:g.map(i=>{var o;return d(N,{children:[c==i&&e(ue,{position:{lat:i.lat,lng:i.long},onCloseClick:()=>n(null),children:d(A,{p:1,children:[e(m,{fontWeight:"medium",children:i.name}),e(m,{children:i.address}),e(he,{as:q,to:`/districts/${(o=t.attributes)==null?void 0:o.LEAID}/schools/${i.id}`,colorScheme:"green",size:"xs",children:"View"})]})}),e(be,{position:{lat:i.lat,lng:i.long},onClick:()=>n(i),children:e(m,{children:i.name})})]})})})})}function $e(){var E,p;const{districtId:r}=V();if(!r)throw new Error("Missing districtId param from URL");const[t,a]=b.exports.useState(""),[c,n]=b.exports.useState(!1),{loading:l,error:g,data:h}=R(Z(r)),{loading:u,error:i,data:o}=R(we(t,r,{searchPrivate:c})),s=(E=h==null?void 0:h.features)==null?void 0:E[0],f=!l&&!s;return d(z,{loading:l||u,breadcrumb:{content:"Home",to:"/"},title:(p=s==null?void 0:s.attributes)==null?void 0:p.LEA_NAME,children:[f&&d(m,{children:["Couldn't"," find a district with ID ",r]}),(s==null?void 0:s.attributes)&&d(A,{spacing:6,children:[d(Y,{spacing:6,justify:"stretch",width:"100%",children:[e(S,{label:"Grades",value:`${s.attributes.GSLO}-${s.attributes.GSHI}`}),e(S,{label:"Schools",value:s.attributes.SCH}),e(S,{label:"Teachers",value:Math.floor(s.attributes.TOTTCH).toLocaleString()}),e(S,{label:"Students",value:Math.floor(s.attributes.MEMBER).toLocaleString()}),e(S,{label:"Students per Teacher",value:s.attributes.STUTERATIO.toLocaleString()})]}),d(A,{spacing:6,alignItems:"stretch",children:[e(S,{label:"Phone",value:s.attributes.PHONE}),e(S,{label:"Address",value:L()})]}),(o==null?void 0:o.features)&&e(J,{district:s,schools:o==null?void 0:o.features})]})]});function L(){if(!(s==null?void 0:s.attributes))return"";const{LSTREET1:x,LSTREET2:T,LCITY:w,LSTATE:D,LZIP:$}=s.attributes;let C=x;return T&&(C+=` ${T}`),C+=` ${w} ${D} ${$}`,C}}const Pe={baseStyle:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},variants:{rounded:{padding:8,borderRadius:"40px",boxShadow:"xl"},smooth:{padding:6,borderRadius:"base",boxShadow:"md"}},defaultProps:{variant:"smooth"}},Me={baseStyle:{fontWeight:"bold",borderRadius:"25px",_hover:{bg:"black"}},sizes:{sm:{fontSize:"sm",px:4,py:3},md:{fontSize:"md",px:6,py:4}},variants:{outline:{border:"2px solid"},ghost:{border:"0px solid"},solid:{color:"white"}},defaultProps:{size:"md",variant:"outline"}},Ne={baseStyle:{bg:"white"}};var _e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Button:Me,Input:Ne});const Fe={brand:{green:"#42E794",darkGreen:"#1E7B75",red:"#FF4658",orange:"#FF6105",lightBlue:"#2ab8ff",darkBlue:"#1467FF",blue:"#2AB8FF",purple:"#630CB2",yellow:"#fff95e"},blue:{500:"#2ab8ff",600:"#1467FF"},yellow:{100:"#fff95e"},red:{100:"#ff4658"},pink:{100:"#e748b9"}},I=ge({colors:Fe,components:j({Card:Pe},_e)});function _(r){const{color:t=I.colors.brand.blue,size:a=["50%","50%"],globSizes:c=[[40,80],[60,50],[20,80]],globPositions:n=[[20,10],[10,20],[20,15]],top:l,left:g,right:h,bottom:u,opacity:i=1,speed:o,radius:s,rotate:f}=r;return d(N,{children:[d("div",{className:"blob",style:{top:l,left:g,right:h,bottom:u,width:a[0],height:a[1],opacity:i,transform:f?`rotate(${f}deg)`:void 0},children:[e("div",{className:"glob",style:{backgroundColor:t,width:c[0][0]+"%",height:c[0][1]+"%",top:n[0][0]+"%",left:n[0][1]+"%",animation:o?`move ${o*1200}ms infinite alternate ease-in-out`:void 0,borderRadius:s}}),e("div",{className:"glob1",style:{backgroundColor:t,width:c[1][0]+"%",height:c[1][1]+"%",top:n[1][0]+"%",left:n[1][1]+"%",animation:o?`move ${o*1e3}ms infinite alternate ease-in-out`:void 0,borderRadius:s}}),e("div",{className:"glob2",style:{backgroundColor:t,width:c[2][0]+"%",height:c[2][1]+"%",top:n[2][0]+"%",left:n[2][1]+"%",animation:o?`move ${o*800}ms infinite alternate ease-in-out`:void 0,borderRadius:s}})]}),e("svg",{className:"glob-svg",xmlns:"http://www.w3.org/2000/svg",version:"1.1",children:e("defs",{children:d("filter",{id:"goo",children:[e("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12",result:"blur"}),e("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9",result:"goo"}),e("feComposite",{in:"SourceGraphic",in2:"goo",operator:"atop"})]})})}),e("svg",{className:"glob-svg",viewBox:"0 0 400 400",children:e("defs",{children:e("filter",{id:"duotone-filter-post-one",children:e("feColorMatrix",{type:"matrix",values:"0.14453125 0 0 0 0.33203125 0.71875 0 0 0 0.27734375 -0.34765625 0 0 0 0.73046875 0 0 0 1 0"})})})})]})}function Ge(){return d(P,{overflow:"hidden",className:"globParent",position:"absolute",width:"100vw",height:"100%",minHeight:"100vh",children:[e(_,{size:["60%","60%"],speed:30,globSizes:[[60,65],[70,80],[30,75]],left:"0%",top:"10%",opacity:.5,color:I.colors.brand.green}),e(_,{size:["600px","600px"],left:"-50px",top:"-20px",color:I.colors.brand.green}),e(_,{size:["60%","60%"],speed:30,globSizes:[[50,90],[80,35],[50,50]],left:"80%",bottom:"-50%",opacity:.5,color:I.colors.brand.darkBlue}),e(_,{size:["60%","70%"],speed:30,globSizes:[[80,55],[50,50],[50,90]],left:"80%",bottom:"-50%",opacity:.5,color:I.colors.brand.blue})]})}function ke(){var p,x,T,w,D,$;const{districtId:r,schoolId:t}=V();if(!r)throw new Error("Missing districtId param from URL");if(!t)throw new Error("Missing schoolId param from URL");const{loading:a,error:c,data:n}=R(Z(r)),{loading:l,error:g,data:h}=R(ye(r,t)),u=(p=n==null?void 0:n.features)==null?void 0:p[0],i=(x=h==null?void 0:h.features)==null?void 0:x[0],o=!a&&!u,s=!l&&!i,f=b.exports.useMemo(()=>L(),[h]);return d(z,{loading:a||l,breadcrumb:{content:(T=u==null?void 0:u.attributes)==null?void 0:T.LEA_NAME,to:`/districts/${(w=u==null?void 0:u.attributes)==null?void 0:w.LEAID}`},title:(D=i==null?void 0:i.attributes)==null?void 0:D.SCH_NAME,children:[o&&d(m,{children:["Couldn't"," find a district with ID ",r]}),s&&d(m,{children:["Couldn't"," find a school with ID ",t]}),(i==null?void 0:i.attributes)&&(u==null?void 0:u.attributes)&&d(A,{spacing:6,children:[d(Y,{spacing:6,children:[e(S,{value:`${i.attributes.GSLO}-${i.attributes.GSHI}`,label:"Grades"}),e(S,{value:Math.floor(i.attributes.FTE),label:"Teachers"}),e(S,{value:Math.floor(i.attributes.TOTAL),label:"Students"}),e(S,{value:($=i.attributes.STUTERATIO)==null?void 0:$.toFixed(2),label:"Students per Teacher"})]}),d(A,{spacing:6,alignItems:"stretch",children:[e(S,{label:"Phone",value:i.attributes.PHONE}),e(S,{label:"Address",value:E()})]}),f&&e(fe,{data:f,style:{maxHeight:"300px"}}),e(J,{district:u,schools:[i]})]})]});function L(){if(!(i==null?void 0:i.attributes))return null;const C=Object.keys(i.attributes).filter(v=>/G[0-9]+|PK|KG/.test(v)).filter(v=>{var y;return((y=i.attributes)==null?void 0:y[v])!=null});return{labels:C.map(v=>v=="PK"?"Pre-kindergarten":v=="KG"?"Kindergarten":v.replace("G","Grade ")),datasets:[{label:"Student count",data:C.map(v=>{var y;return(y=i.attributes)==null?void 0:y[v]}),backgroundColor:[I.colors.green["500"]],borderColor:[I.colors.green["500"]],borderWidth:1,barThickness:50,pointStyle:"rectRounded"}]}}function E(){if(!(i==null?void 0:i.attributes))return"";const{LSTREET1:C,LSTREET2:v,LCITY:y,LSTATE:X,LZIP:Q}=i.attributes;let F=C;return v&&(F+=` ${v}`),F+=` ${y} ${X} ${Q}`,F}}function Be(){return d("div",{className:"App",children:[e(Te,{}),e(Ge,{}),e(W,{width:"4xl",maxWidth:"100%",zIndex:1,marginTop:B,minHeight:`calc(100vh - ${B})`,paddingTop:20,paddingBottom:20,children:e(pe,{basename:"/cs-react-interview-exercise",children:d(me,{children:[e(k,{path:"/",element:e(Re,{})}),e(k,{path:"/districts/:districtId",element:e($e,{})}),e(k,{path:"/districts/:districtId/schools/:schoolId",element:e(ke,{})})]})})})]})}Se.render(e(ve.StrictMode,{children:e(Le,{theme:I,children:e(Be,{})})}),document.getElementById("root"));
